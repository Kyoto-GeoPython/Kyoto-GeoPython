<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SymPyー代数演算</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115860818-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-115860818-2');
  </script>

  <link rel="stylesheet" type="text/css" href="/css/nb-000.css">
  <link rel="stylesheet" type="text/css" href="/css/nb-001.css">
  <link rel="stylesheet" type="text/css" href="/css/nb-002.css">

	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" type="text/css" href="/css/nb-base.css">

  <!-- Loading mathjax macro -->
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          processEnvironments: true
      },
      // Center justify equations in code and markdown cells. Elsewhere
      // we use CSS to left justify single line equations in code cells.
      displayAlign: 'center',
      "HTML-CSS": {
          styles: {'.MathJax_Display': {"margin": 0}},
          linebreaks: { automatic: true }
      }
  });
  </script>
  <!-- End of mathjax configuration -->
</head>
<body>

  <div tabindex="-1" id="notebook" class="border-box-sizing">

    <div class="top-button-container">
      <div class="w3-panel w3-left">
        <h4><a class="w3-button w3-black" href='/'>トップページに戻る</a></h4>
      </div>
    </div>

    <div class="w3-container center-container">
      <div class="container" id="notebook-container">
        <div class="w3-panel">
          <h1 class="w3-center">SymPyー代数演算</h1> 
        </div> 

        <div class="w3-container">

  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SymPy&#12392;&#12399;">SymPy&#12392;&#12399;<a class="anchor-link" href="#SymPy&#12392;&#12399;">&#182;</a></h1><p>代数演算のライブラリです。<br>
Symbolicな演算（文字を数値としてではなくそのまま計算する演算）を可能にします。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sy</span>
<span class="n">sy</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#12471;&#12531;&#12508;&#12523;&#12398;&#23450;&#32681;">&#12471;&#12531;&#12508;&#12523;&#12398;&#23450;&#32681;<a class="anchor-link" href="#&#12471;&#12531;&#12508;&#12523;&#12398;&#23450;&#32681;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># シンボルを定義</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_latex output_subarea output_execute_result">
$$a$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 複数のシンボルを同時に定義</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x y&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># LaTexの記法を使える（raw文字列にしないとエスケープ文字と認識する）</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta \gamma&quot;</span><span class="p">)</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">gamma</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left ( \theta, \quad \gamma\right )$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 正の実数として定義</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 実数として定義</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>文字の情報を与えないと非常に一般的な複素数として計算することがあるので、なるべく情報を与えるようにしましょう。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#22522;&#26412;&#28436;&#31639;">&#22522;&#26412;&#28436;&#31639;<a class="anchor-link" href="#&#22522;&#26412;&#28436;&#31639;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">theta</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_latex output_subarea output_execute_result">
$$- \theta + a^{2} + x$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_latex output_subarea output_execute_result">
$$a$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left(x + y\right)^{3}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#24335;&#12398;&#23637;&#38283;&#12394;&#12393;">&#24335;&#12398;&#23637;&#38283;&#12394;&#12393;<a class="anchor-link" href="#&#24335;&#12398;&#23637;&#38283;&#12394;&#12393;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<span class="n">f</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_latex output_subarea output_execute_result">
$$x^{3} + 3 x^{2} y + 3 x y^{2} + y^{3}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># x^2の係数</span>
<span class="n">f</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_latex output_subarea output_execute_result">
$$3 y$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#24494;&#20998;&#12420;&#26997;&#38480;">&#24494;&#20998;&#12420;&#26997;&#38480;<a class="anchor-link" href="#&#24494;&#20998;&#12420;&#26997;&#38480;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
<span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_latex output_subarea output_execute_result">
$$1$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># xで偏微分</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_latex output_subarea output_execute_result">
$$6 x y + y^{2}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 代入（シンボルも代入できる）</span>
<span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_latex output_subarea output_execute_result">
$$a^{4} x + 3 a^{2} x^{2}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NumPy&#12398;ufunc&#12395;&#22793;&#25563;">NumPy&#12398;ufunc&#12395;&#22793;&#25563;<a class="anchor-link" href="#NumPy&#12398;ufunc&#12395;&#22793;&#25563;">&#182;</a></h2><p>シンボリックな表現をNumPyのufuncに変換できます。<br>
これは結構すごいと思います。<br>
シンボリックな計算をしたあと、数値計算を簡単にすることができます。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x a b c&quot;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
<span class="n">f</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_latex output_subarea output_execute_result">
$$a x^{2} + b x + c$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ４引数を持つ関数を定義</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">func</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 実際に数値を代入(ufuncとして振る舞い、ベクトル演算が可能)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#24540;&#29992;&#20363;">&#24540;&#29992;&#20363;<a class="anchor-link" href="#&#24540;&#29992;&#20363;">&#182;</a></h1><p>SymPyとNumPyの組み合わせが強力であることを示す例として、二重振り子を数値計算で解くということを試みます。<br>
もちろん普通に解いてもしょうがないので、座標設定からラグランジアン、そして運動方程式をシンボリックに求め、最後に数値計算することにします。</p>
<h3 id="&#12514;&#12487;&#12523;&#35373;&#23450;">&#12514;&#12487;&#12523;&#35373;&#23450;<a class="anchor-link" href="#&#12514;&#12487;&#12523;&#35373;&#23450;">&#182;</a></h3><p>原点からy軸負方向に１つ目の質点が長さ$r_1$のひもでぶら下がっていて、その先に２つ目の質点が長さ$r_2$のひもでぶら下がっているとします。<br>
それぞれの質点のy軸とのなす角をそれぞれ$\theta_1, \theta_2$とします。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 変数と関数を定義</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;r_1 r_2 m_1 m_2 g&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># theta1, theta2 = sy.symbols(r&quot;\theta_1 \theta_2&quot;, real=True)</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta_1&quot;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta_2&quot;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\dot{\theta_1} \dot{\theta_2}&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 質点１の位置と速度</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">r1</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)])</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">v1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left ( \left[\begin{matrix}r_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )}\\- r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )}\end{matrix}\right], \quad \left[\begin{matrix}r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )}\\r_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )}\end{matrix}\right]\right )$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 質点２の位置と速度</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">r2</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">)])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">v2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left ( \left[\begin{matrix}r_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} + r_{2} \sin{\left (\theta_{2}{\left (t \right )} \right )}\\- r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )} - r_{2} \cos{\left (\theta_{2}{\left (t \right )} \right )}\end{matrix}\right], \quad \left[\begin{matrix}r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} + r_{2} \cos{\left (\theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{2}{\left (t \right )}\\r_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} + r_{2} \sin{\left (\theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{2}{\left (t \right )}\end{matrix}\right]\right )$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 運動エネルギー</span>
<span class="n">T1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">*</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">T2</span> <span class="o">=</span> <span class="p">(</span><span class="n">m2</span> <span class="o">*</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">T1</span><span class="p">,</span> <span class="n">T2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left ( \frac{m_{1} r_{1}^{2}}{2} \left(\frac{d}{d t} \theta_{1}{\left (t \right )}\right)^{2}, \quad \frac{m_{2}}{2} \left(r_{1}^{2} \left(\frac{d}{d t} \theta_{1}{\left (t \right )}\right)^{2} + 2 r_{1} r_{2} \cos{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} \frac{d}{d t} \theta_{2}{\left (t \right )} + r_{2}^{2} \left(\frac{d}{d t} \theta_{2}{\left (t \right )}\right)^{2}\right)\right )$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ポテンシャル</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">x2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">V1</span><span class="p">,</span> <span class="n">V2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left ( - g m_{1} r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )}, \quad g m_{2} \left(- r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )} - r_{2} \cos{\left (\theta_{2}{\left (t \right )} \right )}\right)\right )$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>運動エネルギーとポテンシャルが求まったので、ラグランジアン $L(\theta_1, \theta_2, \dot{\theta_1}, \dot{\theta_2})$ を得ることができます。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">T2</span> <span class="o">-</span> <span class="n">V1</span> <span class="o">-</span> <span class="n">V2</span>
<span class="n">L</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[23]:</div>




<div class="output_latex output_subarea output_execute_result">
$$g m_{1} r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )} - g m_{2} \left(- r_{1} \cos{\left (\theta_{1}{\left (t \right )} \right )} - r_{2} \cos{\left (\theta_{2}{\left (t \right )} \right )}\right) + \frac{m_{1} r_{1}^{2}}{2} \left(\frac{d}{d t} \theta_{1}{\left (t \right )}\right)^{2} + \frac{m_{2}}{2} \left(r_{1}^{2} \left(\frac{d}{d t} \theta_{1}{\left (t \right )}\right)^{2} + 2 r_{1} r_{2} \cos{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} \frac{d}{d t} \theta_{2}{\left (t \right )} + r_{2}^{2} \left(\frac{d}{d t} \theta_{2}{\left (t \right )}\right)^{2}\right)$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>だんだん結果は複雑になってきましたが、人間側は相当楽をしています。<br>
ラグランジアンから運動方程式はそれぞれ、
$$\frac{d}{dt} \frac{\partial L}{\partial \dot{\theta_1}}=\frac{\partial L}{\partial \theta_1}$$
$$\frac{d}{dt} \frac{\partial L}{\partial \dot{\theta_2}}=\frac{\partial L}{\partial \theta_2}$$
となるので、</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 質点１の運動方程式</span>
<span class="n">EOM_1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta1</span><span class="p">))</span> 
<span class="n">EOM_1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>




<div class="output_latex output_subarea output_execute_result">
$$m_{1} r_{1}^{2} \frac{d^{2}}{d t^{2}}  \theta_{1}{\left (t \right )} + \frac{m_{2}}{2} \left(2 r_{1}^{2} \frac{d^{2}}{d t^{2}}  \theta_{1}{\left (t \right )} - 2 r_{1} r_{2} \left(\frac{d}{d t} \theta_{1}{\left (t \right )} - \frac{d}{d t} \theta_{2}{\left (t \right )}\right) \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{2}{\left (t \right )} + 2 r_{1} r_{2} \cos{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d^{2}}{d t^{2}}  \theta_{2}{\left (t \right )}\right) = - g m_{1} r_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} - g m_{2} r_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} - m_{2} r_{1} r_{2} \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} \frac{d}{d t} \theta_{2}{\left (t \right )}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 質点２の運動方程式</span>
<span class="n">EOM_2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta2</span><span class="p">))</span> 
<span class="n">EOM_2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\frac{m_{2}}{2} \left(- 2 r_{1} r_{2} \left(\frac{d}{d t} \theta_{1}{\left (t \right )} - \frac{d}{d t} \theta_{2}{\left (t \right )}\right) \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} + 2 r_{1} r_{2} \cos{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d^{2}}{d t^{2}}  \theta_{1}{\left (t \right )} + 2 r_{2}^{2} \frac{d^{2}}{d t^{2}}  \theta_{2}{\left (t \right )}\right) = - g m_{2} r_{2} \sin{\left (\theta_{2}{\left (t \right )} \right )} + m_{2} r_{1} r_{2} \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \frac{d}{d t} \theta_{1}{\left (t \right )} \frac{d}{d t} \theta_{2}{\left (t \right )}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$\ddot{\theta_1}, \ddot{\theta_2}$について解くと、</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">EOMs</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">EOM_1</span><span class="p">,</span> <span class="n">EOM_2</span><span class="p">],</span> <span class="p">(</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">EOMs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_latex output_subarea output_execute_result">
$$\left \{ \frac{d^{2}}{d t^{2}}  \theta_{1}{\left (t \right )} : \frac{1}{r_{1} \left(- m_{1} + m_{2} \cos^{2}{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} - m_{2}\right)} \left(g m_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} + \frac{g m_{2}}{2} \sin{\left (\theta_{1}{\left (t \right )} - 2 \theta_{2}{\left (t \right )} \right )} + \frac{g m_{2}}{2} \sin{\left (\theta_{1}{\left (t \right )} \right )} + \frac{m_{2} r_{1}}{2} \sin{\left (2 \theta_{1}{\left (t \right )} - 2 \theta_{2}{\left (t \right )} \right )} \left(\frac{d}{d t} \theta_{1}{\left (t \right )}\right)^{2} + m_{2} r_{2} \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \left(\frac{d}{d t} \theta_{2}{\left (t \right )}\right)^{2}\right), \quad \frac{d^{2}}{d t^{2}}  \theta_{2}{\left (t \right )} : \frac{1}{r_{2} \left(- m_{1} + m_{2} \cos^{2}{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} - m_{2}\right)} \left(\left(m_{1} + m_{2}\right) \left(g \sin{\left (\theta_{2}{\left (t \right )} \right )} - r_{1} \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \left(\frac{d}{d t} \theta_{1}{\left (t \right )}\right)^{2}\right) - \left(g m_{1} \sin{\left (\theta_{1}{\left (t \right )} \right )} + g m_{2} \sin{\left (\theta_{1}{\left (t \right )} \right )} + m_{2} r_{2} \sin{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )} \left(\frac{d}{d t} \theta_{2}{\left (t \right )}\right)^{2}\right) \cos{\left (\theta_{1}{\left (t \right )} - \theta_{2}{\left (t \right )} \right )}\right)\right \}$$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 関数を変数に置き換える</span>
<span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta_1 \theta_2&quot;</span><span class="p">)</span>
<span class="n">diff2dot</span> <span class="o">=</span> <span class="p">[(</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">theta1_dot</span><span class="p">),</span>
            <span class="p">(</span><span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">theta2_dot</span><span class="p">)]</span>
<span class="n">theta1_ddot</span> <span class="o">=</span> <span class="n">EOMs</span><span class="p">[</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">diff2dot</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="p">(</span><span class="n">theta2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)])</span>
<span class="n">theta2_ddot</span> <span class="o">=</span> <span class="n">EOMs</span><span class="p">[</span><span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">diff2dot</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="p">(</span><span class="n">theta2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># NumPyの関数に変換する</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">func1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">theta1_ddot</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
<span class="n">func2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">theta2_ddot</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 数値計算</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">ode</span>

<span class="k">def</span> <span class="nf">time_evolve</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span><span class="p">,</span>
            <span class="n">func1</span><span class="p">(</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span>
            <span class="n">func2</span><span class="p">(</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)]</span>

<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;m1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;m2&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;r1&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="mf">9.8</span><span class="p">}</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">time_evolve</span><span class="p">)</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">solver</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">tmax</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">solver</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;theta1&quot;</span><span class="p">,</span> <span class="s2">&quot;theta2&quot;</span><span class="p">,</span> <span class="s2">&quot;theta1_dot&quot;</span><span class="p">,</span> <span class="s2">&quot;theta2_dot&quot;</span><span class="p">])</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta1</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;x2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta2</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;y1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta1</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;y2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>

<span class="k">def</span> <span class="nf">gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;y1&quot;</span><span class="p">,</span> <span class="s2">&quot;y2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">yield</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span>

<span class="k">def</span> <span class="nf">plot_double_pendulum</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">plot_double_pendulum</span><span class="p">,</span> <span class="n">gen</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">save_count</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;double_pendulum.gif&quot;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s2">&quot;imagemagick&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="double_pendulum.gif"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#12414;&#12392;&#12417;&#12427;&#12392;">&#12414;&#12392;&#12417;&#12427;&#12392;<a class="anchor-link" href="#&#12414;&#12392;&#12417;&#12427;&#12392;">&#182;</a></h3><p>一つのセルにまとめると以下のように書けます。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 変数と関数を定義</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;r_1 r_2 m_1 m_2 g&quot;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># theta1, theta2 = sy.symbols(r&quot;\theta_1 \theta_2&quot;, real=True)</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta_1&quot;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta_2&quot;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\dot{\theta_1} \dot{\theta_2}&quot;</span><span class="p">)</span>

<span class="c1"># 質点１の位置と速度</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">r1</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)])</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># 質点２の位置と速度</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">sy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">r2</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">sy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">)])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># 運動エネルギー</span>
<span class="n">T1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">*</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">T2</span> <span class="o">=</span> <span class="p">(</span><span class="n">m2</span> <span class="o">*</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>

<span class="c1"># ポテンシャル</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">x2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># ラグランジアン</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">T2</span> <span class="o">-</span> <span class="n">V1</span> <span class="o">-</span> <span class="n">V2</span>

<span class="c1"># 質点１、２の運動方程式</span>
<span class="n">EOM_1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta1</span><span class="p">))</span> 
<span class="n">EOM_2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">L</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theta2</span><span class="p">))</span> 

<span class="c1"># 加速度について解く</span>
<span class="n">EOMs</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">EOM_1</span><span class="p">,</span> <span class="n">EOM_2</span><span class="p">],</span> <span class="p">(</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>

<span class="c1"># 関数を変数に変換</span>
<span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\theta_1 \theta_2&quot;</span><span class="p">)</span>
<span class="n">diff2dot</span> <span class="o">=</span> <span class="p">[(</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">theta1_dot</span><span class="p">),</span>
            <span class="p">(</span><span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">theta2_dot</span><span class="p">)]</span>
<span class="n">theta1_ddot</span> <span class="o">=</span> <span class="n">EOMs</span><span class="p">[</span><span class="n">theta1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">diff2dot</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="p">(</span><span class="n">theta2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)])</span>
<span class="n">theta2_ddot</span> <span class="o">=</span> <span class="n">EOMs</span><span class="p">[</span><span class="n">theta2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">diff2dot</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="p">(</span><span class="n">theta2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)])</span>

<span class="c1"># NumPy関数化</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">func1</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">theta1_ddot</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
<span class="n">func2</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">theta2_ddot</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)</span>

<span class="c1"># 数値計算</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">ode</span>

<span class="k">def</span> <span class="nf">time_evolve</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span><span class="p">,</span>
            <span class="n">func1</span><span class="p">(</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span>
            <span class="n">func2</span><span class="p">(</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)]</span>

<span class="c1"># 初期値</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;m1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;m2&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;r1&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="mf">9.8</span><span class="p">}</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">time_evolve</span><span class="p">)</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">solver</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">tmax</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">solver</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;theta1&quot;</span><span class="p">,</span> <span class="s2">&quot;theta2&quot;</span><span class="p">,</span> <span class="s2">&quot;theta1_dot&quot;</span><span class="p">,</span> <span class="s2">&quot;theta2_dot&quot;</span><span class="p">])</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta1</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;x2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta2</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;y1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;r1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta1</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;y2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">theta2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
 



        </div>
      </div>
    </div>

		<div class="w3-row-padding w3-padding w3-left-aligned w3-panel">
			<div class="w3-half w3-padding w3-container">
				<h2 class="w3-xxlarge w3-padding w3-blue">基礎編</h2>
				<div class="w3-padding">
					<p><a href="/html/基礎編/Pythonの基礎1.html">Pythonの基礎（１）</a></p>
					<p><a href="/html/基礎編/Pythonの基礎2.html">Pythonの基礎（２）</a></p>
					<p><a href="/html/基礎編/Matplotlib.html">Matplotlib</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（１）導入.html">Numpyの基礎 ― 導入</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（２）生成関数.html">Numpyの基礎 ― 生成関数</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（３）ufunc.html">Numpyの基礎 ― 配列に関数を作用させる</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（４）データ型.html">Numpyの基礎 ― データ型（C,Fortranとの比較）</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（５）要素の参照.html">Numpyの基礎 ― 要素の取り出し方</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（６）ブロードキャスト.html">Numpyの基礎 ― ブロードキャスト</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（７）便利なライブラリ群.html">Numpyの基礎 ― 線形代数やフーリエ変換</a></p>
					<p><a href="/html/基礎編/Numpyの基礎（８）ファイル入出力.html">Numpyの基礎 ― 様々な形式に対応したファイル入出力</a></p>
					<p><a href="/html/基礎編/ファイル読み込み.html">ファイル読み込み</a></p>
					<p><a href="/html/基礎編/文字列操作（１）str.format.html">文字列操作 ― 数値を文字列にフォーマットする</a></p>
					<p><a href="/html/基礎編/文字列操作（２）strやファイル読み込み.html">文字列操作 ― 文字列に関数を適用する</a></p>
					<p><a href="/html/基礎編/読みやすいPythonコードを書こう.html">読みやすいPythonコードを書こう</a></p>
				</div>
			</div>
			<div class="w3-half w3-padding w3-container">
				<h2 class="w3-xxlarge w3-padding w3-orange">応用編</h2>
				<div class="w3-padding">
					<p><a href="/html/応用編/Animation.html">Animation</a></p>
					<p><a href="/html/応用編/Fortran, C言語 との連携.html">Fortran, C言語 との連携</a></p>
					<p><a href="/html/応用編/Pandas―データ分析（１）Series.html">Pandas ― データ分析（１）時系列などをうまく扱えるようにする</a></p>
					<p><a href="/html/応用編/Pandas―データ分析（２）DataFrame.html">Pandas ― データ分析（２）複数の列を持った表形式でデータを格納する</a></p>
					<p><a href="/html/応用編/Pandas―データ分析（３）GroupBy.html">Pandas ― データ分析（３）データを分割し、個別に集計する</a></p>
					<p><a href="/html/応用編/Pandas―データ分析（４）ファイル入出力.html">Pandas ― データ分析（４）高度なファイル入出力</a></p>
					<p><a href="/html/応用編/Pandas―データ分析（５）応用：都道府県別人口推移.html">Pandas ― データ分析（５）応用：都道府県別人口推移</a></p>
					<p><a href="/html/応用編/Seaborn ― matplotlib をより美しく、使いやすく.html">Seaborn ― matplotlib をより美しく、使いやすく</a></p>
					<p><a href="/html/応用編/shやBashの代わりにPythonを使う.html">shやBashの代わりにPythonを使う</a></p>
					<p><a href="/html/応用編/SymPyー代数演算（１）使い方.html">SymPy ― 代数演算（１）文字を文字のまま計算する</a></p>
					<p><a href="/html/応用編/SymPyー代数演算（２）応用：二重振り子.html">SymPy ― 代数演算（２）応用：ラグランジアンから運動方程式を求めて二重振り子を解く</a></p>
				</div>
			</div>
		</div>

    <div class="footer-button-container">
      <div class="w3-panel w3-center">
        <h4><a class="w3-button w3-black" href='/'>トップページに戻る</a></h4>
      </div>
    </div>

</body>

 


</html>