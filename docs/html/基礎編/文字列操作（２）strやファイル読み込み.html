<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>文字列操作（２）strやファイル読み込み</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115860818-2"></script>
  <script>
    window.dataLayer = window.dataLayer || []
    function gtag() {
      dataLayer.push(arguments)
    }
    gtag("js", new Date())

    gtag("config", "UA-115860818-2");
  </script>

  <link rel="stylesheet" type="text/css" href="/css/nb-000.css" />
  <link rel="stylesheet" type="text/css" href="/css/nb-001.css" />
  <link rel="stylesheet" type="text/css" href="/css/nb-002.css" />

  <link rel="stylesheet" href="/css/w3.css" />
  <link rel="stylesheet" type="text/css" href="/css/nb-base.css" />

  <!-- Loading mathjax macro -->
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true,
              processEnvironments: true
          },
          // Center justify equations in code and markdown cells. Elsewhere
          // we use CSS to left justify single line equations in code cells.
          displayAlign: 'center',
          "HTML-CSS": {
              styles: {'.MathJax_Display': {"margin": 0}},
              linebreaks: { automatic: true }
          }
      });
    </script>
  <!-- End of mathjax configuration -->
</head>

<body>
  <div class="top-button-container">
    <div class="w3-panel w3-left">
      <h4><a class="w3-button w3-black" href="/">トップページに戻る</a></h4>
    </div>
  </div>

  <div tabindex="-1" id="notebook" class="border-box-sizing must-no-padding">
    <div class="container my-notebook-container must-no-padding" id="notebook-container">
      <div class="w3-panel">
        <h1 class="w3-center">文字列操作（２）strやファイル読み込み</h1>
      </div>

      <div class="w3-container w3-padding-small"><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="%E7%9B%AE%E6%AC%A1">&#30446;&#27425;<a class="anchor-link" href="#%E7%9B%AE%E6%AC%A1">&#182;</a></h1><ul>
<li>strクラスの便利な関数<ul>
<li>str.strip</li>
<li>str.split</li>
<li>str.replace</li>
</ul>
</li>
<li>テキストファイル読み込み</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="str%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E4%BE%BF%E5%88%A9%E3%81%AA%E9%96%A2%E6%95%B0">str&#12463;&#12521;&#12473;&#12398;&#20415;&#21033;&#12394;&#38306;&#25968;<a class="anchor-link" href="#str%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E4%BE%BF%E5%88%A9%E3%81%AA%E9%96%A2%E6%95%B0">&#182;</a></h2><p>strクラスには、str.format以外にも使い勝手の良い関数が多数用意されています。<br />
ここでは、そのうちファイル入力を処理する際などに役立つ関数を紹介します。</p>
<h3 id="str.strip">str.strip<a class="anchor-link" href="#str.strip">&#182;</a></h3><p>stripは「取り除く、奪う」などの意味を持つ単語ですが、その名の通りこの関数は文字列の最初や最後にある余計な空白や改行文字を取り除いてくれます。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#最初と最後の空白を取り除く</span>
<span class="s2">"       空白が        たくさん     あるよ　　　"</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;空白が        たくさん     あるよ&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 改行文字も取り除く</span>
<span class="s2">"      最後に  改行文字が   含まれる例    </span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;最後に  改行文字が   含まれる例&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="str.split">str.split<a class="anchor-link" href="#str.split">&#182;</a></h3><p>この関数では、指定した区切り文字で文字列を分割して文字列のリストを返します。区切り文字を指定しない場合、スペースやタブのような空白でうまいこと分割してくれるので、まずは区切り文字を指定しないでやってみることをおすすめします。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#スペースで分割</span>
<span class="s2">"a b c"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#タブやスペースが混在しててもうまく分割してくれる</span>
<span class="s2">"a </span><span class="se">\t</span><span class="s2">   b  </span><span class="se">\t</span><span class="s2">  c"</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#区切り文字を指定する場合</span>
<span class="s2">"csvファイルなどに,使う場合を,想定しています"</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;csvファイルなどに&#39;, &#39;使う場合を&#39;, &#39;想定しています&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="str.replace">str.replace<a class="anchor-link" href="#str.replace">&#182;</a></h3><p>その名の通り、文字列に含まれるある文字を別の文字に置き換えた文字列を返す関数です。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s2">"あいうあいう"</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"あ"</span><span class="p">,</span><span class="s2">"い"</span><span class="p">)</span> <span class="c1"># "あ"を"い"に置き換える</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;いいういいう&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">&#12486;&#12461;&#12473;&#12488;&#12501;&#12449;&#12452;&#12523;&#35501;&#12415;&#36796;&#12415;<a class="anchor-link" href="#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">&#182;</a></h2><p><strong>with</strong>構文をファイル入出力の際に使いましょう。<br />
エラーが起きても、ファイルを自動的に閉じてくれるため、安全にファイル入出力を行うことができます。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ファイルの最後までを文字列としてdataに入れる</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"data.txt"</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 下はwith構文で書いた場合と大体等価ですが、</span>
<span class="c1"># １行増えた上にインデントがなく、読みにくい</span>
<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"data.txt"</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>一行ずつ読み取りたい場合は、fpに対してforループを回すと良いです。<br />
下の例では、各行が改行文字を含んだまま取り出されているので<strong>str.strip</strong>関数でそれを取り除いています。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"data.txt"</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&#34;都道府県コード&#34;,&#34;都道府県名&#34;,&#34;元号&#34;,&#34;和暦（年）&#34;,&#34;西暦（年）&#34;,&#34;注&#34;,&#34;人口（総数）&#34;,&#34;人口（男）&#34;,&#34;人口（女）&#34;
&#34;00&#34;,&#34;全国&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,55963053,28044185,27918868
&#34;01&#34;,&#34;北海道&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,2359183,1244322,1114861
&#34;02&#34;,&#34;青森県&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,756454,381293,375161
&#34;03&#34;,&#34;岩手県&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,845540,421069,424471
&#34;04&#34;,&#34;宮城県&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,961768,485309,476459
&#34;05&#34;,&#34;秋田県&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,898537,453682,444855
&#34;06&#34;,&#34;山形県&#34;,&#34;大正&#34;,9,1920,&#34;&#34;,968925,478328,490597
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>テキストファイルはそれぞれに異なる文字コードが使われています。<br />
もともとの文字コードと違う文字コードで読み込もうとすると「文字化け」と言われる現象が起きます。<br />
うまくテキストファイルをopenできない場合、以下のencodingを試してみると良いです。</p>
<ul>
<li>utf-8</li>
<li>shift-jis</li>
<li>cp932</li>
<li>euc-jp</li>
</ul>
<p>大概のテキストファイルはどれかに当てはまります。</p>

</div>
</div>
</div>


</div>
    </div>
  </div>

  <div class="w3-row-padding w3-padding-small w3-left-aligned w3-panel">
    <div class="w3-half w3-padding-small w3-container">
      <h2 class="w3-xxlarge w3-padding-small w3-blue">基礎編</h2>
      <div class="w3-row-padding bottom-links">
        <p>
          <a href="/html/基礎編/Pythonの基礎1.html">Pythonの基礎（１）</a>
        </p>
        <p>
          <a href="/html/基礎編/Pythonの基礎2.html">Pythonの基礎（２）</a>
        </p>
        <p><a href="/html/基礎編/Matplotlib.html">Matplotlib</a></p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（１）導入.html">Numpyの基礎（１）導入</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（２）生成関数.html">Numpyの基礎（２）生成関数</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（３）ufunc.html">Numpyの基礎（３）配列に関数を作用させる</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（４）データ型.html">Numpyの基礎（４）データ型（C,Fortranとの比較）</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（５）要素の参照.html">Numpyの基礎（５）要素の取り出し方</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（６）ブロードキャスト.html">Numpyの基礎（６）ブロードキャスト</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（７）便利なライブラリ群.html">Numpyの基礎（７）線形代数やフーリエ変換</a>
        </p>
        <p>
          <a href="/html/基礎編/Numpyの基礎（８）ファイル入出力.html">Numpyの基礎（８）様々な形式に対応したファイル入出力</a>
        </p>
        <p>
          <a href="/html/基礎編/ファイル読み込み.html">ファイル読み込み</a>
        </p>
        <p>
          <a href="/html/基礎編/文字列操作（１）str.format.html">文字列操作（１）数値を文字列にフォーマットする</a>
        </p>
        <p>
          <a href="/html/基礎編/文字列操作（２）strやファイル読み込み.html">文字列操作（２）文字列に関数を適用する</a>
        </p>
        <p>
          <a href="/html/基礎編/読みやすいPythonコードを書こう.html">読みやすいPythonコードを書こう</a>
        </p>
      </div>
    </div>
    <div class="w3-half w3-padding-small w3-container">
      <h2 class="w3-xxlarge w3-padding-small w3-orange">応用編</h2>
      <div class="w3-row-padding bottom-links">
        <p><a href="/html/応用編/Animation.html">Animation</a></p>
        <p>
          <a href="/html/応用編/Fortran, C言語 との連携.html">Fortran, C言語 との連携</a>
        </p>
        <p>
          <a href="/html/応用編/Pandas―データ分析（１）Series.html">Pandas ― データ分析（１）時系列などをうまく扱えるようにする</a>
        </p>
        <p>
          <a href="/html/応用編/Pandas―データ分析（２）DataFrame.html">Pandas ― データ分析（２）複数の列を持った表形式でデータを格納する</a>
        </p>
        <p>
          <a href="/html/応用編/Pandas―データ分析（３）GroupBy.html">Pandas ― データ分析（３）データを分割し、個別に集計する</a>
        </p>
        <p>
          <a href="/html/応用編/Pandas―データ分析（４）ファイル入出力.html">Pandas ― データ分析（４）高度なファイル入出力</a>
        </p>
        <p>
          <a href="/html/応用編/Pandas―データ分析（５）応用：都道府県別人口推移.html">Pandas ― データ分析（５）応用：都道府県別人口推移</a>
        </p>
        <p>
          <a href="/html/応用編/Seaborn ― matplotlib をより美しく、使いやすく.html">Seaborn ― matplotlib をより美しく、使いやすく</a>
        </p>
        <p>
          <a href="/html/応用編/shやBashの代わりにPythonを使う.html">shやBashの代わりにPythonを使う</a>
        </p>
        <p>
          <a href="/html/応用編/SymPyー代数演算（１）使い方.html">SymPy ― 代数演算（１）文字を文字のまま計算する</a>
        </p>
        <p>
          <a href="/html/応用編/SymPyー代数演算（２）応用：二重振り子.html">SymPy ―
            代数演算（２）応用：ラグランジアンから運動方程式を求めて二重振り子を解く</a>
        </p>
        <p>
          <a href="/html/応用編/高速化Tips.html">高速化Tips</a>
        </p>
      </div>
    </div>
  </div>

  <div class="footer-button-container">
    <div class="w3-panel w3-center">
      <h4><a class="w3-button w3-black" href="/">トップページに戻る</a></h4>
    </div>
  </div>
</body>

</html>